Here is the complete, single-file code.

I have implemented a **Master State Controller** (`updateTerminalState`) that runs on every interaction. This ensures the flow is strictly sequential and self-correcting.

**Key Changes Implemented:**

1. **Dynamic Placeholders:** Disabled fields now explain *why* they are disabled inside the input box itself (e.g., "ENTER USERNAME FIRST").
2. **Sequential Locking:** You cannot jump ahead. Changing an earlier field (like deleting the Username) re-locks later fields to prevent invalid states, but retains the data.
3. **Phase Indicators:** The system message line (`#s1msg`) provides immediate, non-intrusive feedback when a phase is completed (e.g., "IDENTITY OK â€” SCORING UNLOCKED").
4. **Submission Lock:** The data transmission (`fetch`) has been removed, and the summary screen now explicitly states that the window is closed.

```html
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GOALSTORM! â€” WORLD CUP 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#050510;
  --panel:#0b0b1f; --neon:#00f6ff; --ok:#22ff88; --warn:#ffcc00; --dim:#666;
  --cyan:#00F6FF;
  --yellow:#FFD60A; --pink:#FF2FC7; --white:#F7F7F2; --purple:#B026FF;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{
    margin:0;
    background:radial-gradient(circle at top,#0c0c2a,#000);
    color:#fff;
    font-family:"Press Start 2P",monospace;
    text-align:center;
    display:flex;
    flex-direction:column;
    align-items:center;
    min-height: 100vh;
}
/* NAV */
.nav {
  width: 100%;
  max-width: 960px;
  display: flex;
  justify-content: space-around;
  margin: 16px auto 10px;
  padding: 0 10px;
  gap: 6px;
}
.nav a {
  flex: 1;
  font-size: 10px;
  padding: 12px 4px;
  color: #567;
  text-decoration: none;
  border: 1px solid rgba(0,246,255,.25);
  box-shadow: 0 0 6px rgba(0,246,255,.1);
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  transition: all 0.2s;
  background: transparent;
}
.nav a:hover { color: var(--purple); }
.nav a.active { 
  color: var(--white);
  background: var(--purple); 
  border: 2px solid var(--white); 
  box-shadow: 0 0 15px var(--purple); 
  text-shadow: 2px 2px 0px #000;
}
/* PANELS */
.panel{
    width:100%;
    max-width:960px;
    background:var(--panel);
    border:2px solid var(--neon);
    box-shadow:0 0 15px rgba(0,246,255,.2); 
    padding:25px;
    margin-bottom:20px;
}
h1{
    font-size:20px;
    margin:0 0 20px;
    color:var(--neon);
    text-shadow:2px 2px 0px #000; 
    line-height: 1.4;
}
/* SYSTEM TEXT STYLING */
.sys{margin:12px 0;font-size:12px;color:var(--dim);line-height:1.8; min-height: 24px; transition: color 0.3s;}
.sys.active { color: var(--neon); }
.sys.complete { color: var(--ok); }
.sys.prominent, .sys.intro {
    color: var(--white);
    font-size: 14px;
    text-shadow: 2px 2px 0 #000;
    line-height: 1.6;
}
.sys.intro { margin-bottom: 10px; }

/* BANNER */
.banner {
  max-width: 600px;
  width: 100%;
  height: auto;
  display: block;
  margin-bottom: 20px;
}

/* INPUTS */
input, select{
    width:100%;
    padding:14px;
    margin:12px 0;
    background:#222;
    color:#fff;
    border:2px solid #777;
    font-family:inherit;
    font-size:12px;
    outline: none;
    transition: all 0.3s ease;
}
input::placeholder { color: #888; transition: color 0.3s; }
input:focus, select:focus {
    border-color: var(--neon);
    background: #000;
    box-shadow: 0 0 8px rgba(0,246,255,0.4);
}
/* DISABLED STATES */
input:disabled, select:disabled{
    opacity: 0.5; 
    border-color: #444;
    background: #151515;
    cursor: not-allowed;
    color: #888;
}
/* Specific style for disabled placeholders to act as instructions */
input:disabled::placeholder {
    color: var(--warn);
    opacity: 0.8;
}

button{
    padding:12px 18px;
    margin:8px;
    font-family:inherit;
    font-size:12px;
    background:#000;
    color:var(--neon);
    border:2px solid var(--neon);
    cursor:pointer;
}
button:disabled{opacity:.35;border-color:var(--dim);color:var(--dim);cursor:not-allowed;}
.group{border:1px solid var(--dim);margin:12px 0;padding:15px; background: rgba(255,255,255,0.03);}
.groups-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-top:15px;}
.group h4{font-size:12px;margin-bottom:10px;color:var(--neon);text-transform:uppercase;}
.team-list{display:flex;flex-direction:column;gap:8px;width:100%;}
.team-row{display:flex;justify-content:space-between;align-items:center;gap:6px;}
.team-name{font-size:12px;color:#fff;flex:1;text-align:left; line-height: 1.4;}
.team-btn{
    font-family:'Press Start 2P',monospace;
    font-size:10px;
    padding:6px 8px;
    border-radius:4px;
    border:1px solid var(--neon);
    background:transparent;
    color:var(--neon);
    cursor:pointer;
    outline:none;
    min-height:30px;
    transition:all .1s;
}
.team-btn.selected-2{background:var(--ok);color:#000;border-color:var(--ok);box-shadow:0 0 8px var(--ok);}
.team-btn.selected-3{background:var(--pink);color:#000;border-color:var(--pink);box-shadow:0 0 8px var(--pink);}

/* TERMS & CONDITIONS CHECKBOXES */
.terms-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin: 15px 0;
    align-items: flex-start;
    padding-left: 5px;
}
.terms-container label {
    font-size: 10px;
    color: var(--neon);
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    text-align: left;
    line-height: 1.4;
    flex-wrap: nowrap;
}
.terms-container .required-text {
    color: var(--pink);
    font-weight: bold;
    white-space: nowrap;
}
.terms-container input[type="checkbox"] {
    width: auto;
    margin: 0;
    transform: scale(1.5);
    cursor: pointer;
    border: 2px solid #777;
}

/* ARCADE POPUP (ERROR & PROGRESS) */
.arcade-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #000;
    border: 4px solid var(--pink);
    padding: 20px;
    z-index: 1000;
    width: 90%;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 0 30px rgba(0,0,0,0.9);
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
.arcade-popup.progress-mode {
    border-color: var(--neon);
}
.popup-msg {
    color: #fff;
    font-size: 12px;
    line-height: 1.6;
    margin-bottom: 15px;
    text-shadow: 2px 2px 0 #000;
}
.popup-btn {
    background: var(--pink);
    color: #000;
    border: none;
    padding: 10px 20px;
    font-family: "Press Start 2P";
    cursor: pointer;
}
.popup-btn:hover { background: #fff; }

/* POPUP CLOSE BUTTON (MINIMAL) */
.popup-close-x {
    position: absolute;
    top: 8px;
    right: 10px;
    background: none;
    border: none;
    color: var(--white);
    font-size: 14px;
    cursor: pointer;
    font-family: sans-serif;
}

/* PROGRESS BAR STYLES */
.progress-track {
    width: 100%;
    height: 20px;
    background: #222;
    border: 2px solid #555;
    margin-top: 10px;
    position: relative;
}
.progress-fill {
    height: 100%;
    background: var(--neon);
    width: 0%;
    transition: width 0.3s ease;
}
/* INFO TOOLTIP */
.info-tooltip {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #000;
    border: 3px solid var(--neon);
    padding: 20px;
    z-index: 999;
    width: 90%;
    max-width: 450px;
    text-align: center;
    box-shadow: 0 0 30px rgba(0,246,255,0.5);
    display: none;
}
.info-tooltip .tooltip-text {
    color: #fff;
    font-size: 11px;
    line-height: 1.8;
    text-shadow: 2px 2px 0 #000;
}
/* MODAL */
.overlay{position:fixed;inset:0;background:rgba(10,10,26,0.96);display:none;align-items:center;justify-content:center;z-index:10;}
.modal{width:92%;max-width:960px;text-align:center;}
.top-player{border:6px solid var(--yellow);padding:16px;font-size:18px;margin-bottom:12px;text-shadow:0 0 12px var(--yellow);min-height:60px;display:flex;align-items:center;justify-content:center;}
.subtitle{font-size:10px;margin-bottom:18px;color:var(--yellow);}
.actions{display:flex;justify-content:center;gap:20px;margin-bottom:20px;}
.grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-bottom:20px;}
@media(max-width:600px){ .grid{grid-template-columns:repeat(3,1fr);} }
.player-box{
  border:2px solid rgba(0,246,255,0.2);
  padding:10px 4px;
  font-size:9px;
  text-align:center;
  transition:all .05s;
  color: #888;
}
.player-box.active{
  transform: scale(1.05);
  z-index: 5;
  font-weight: bold;
}
.player-box.selected{
 border-color:var(--yellow) !important;
  color:var(--yellow) !important;
  background: #000 !important;
  text-shadow:0 0 10px var(--yellow);
  box-shadow: inset 0 0 15px rgba(255,214,10,0.3) !important;
  transform: scale(1.1);
}
.info{font-size:9px;margin-top:14px;color:var(--pink);}
.success{display:none;font-size:14px;color:var(--yellow);text-shadow:0 0 12px var(--yellow);}
.shake{animation:shake 0.35s;}
@keyframes shake{0%,100%{transform:translate(0,0);}20%{transform:translate(-6px,0);}40%{transform:translate(6px,0);}60%{transform:translate(-4px,0);}80%{transform:translate(4px,0);}}

/* FINAL POPUP */
.submit-overlay{position:fixed;inset:0;background:rgba(5,5,16,0.98);display:none;align-items:center;justify-content:center;z-index:20;}
.submit-box{max-width:900px;width:94%;border:4px solid var(--yellow);padding:20px;background:#000;}
.submit-box h2{font-size:16px;color:var(--yellow);margin-bottom:14px;}
.submit-box .details{font-size:9px;text-align:left;line-height:1.6;margin-bottom:16px;}
.submit-box .hint{font-size:9px;color:var(--pink);margin-bottom:16px;}
.submit-box a{display:inline-block;margin-top:10px;color:var(--neon);text-decoration:none;border:2px solid var(--neon);padding:8px 10px;}

/* SUMMARY GRID STYLES */
.summary-header{border-bottom:1px solid var(--dim);padding-bottom:12px;margin-bottom:12px;}
.summary-players{color:var(--neon);font-size:11px;margin-bottom:16px;line-height:1.5;}
.summary-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:8px;border-top:1px solid var(--dim);padding-top:12px;}
.summary-item{background:#111;border:1px solid var(--dim);padding:8px;display:flex;flex-direction:column;justify-content:center;}
.summary-item h5{color:var(--yellow);margin-bottom:6px;font-size:9px;}
.summary-item span{display:block;margin-bottom:3px;font-size:8px;color:#fff;}
.summary-item span.third{color:var(--pink);}
</style>
</head> <body> 

<div class="nav" id="nav">
  <a href="index.html">HOME</a>
  <a href="predict.html" class="active">PLAY</a>
  <a href="scores.html">SCORES</a>
  <a href="rules.html">RULES</a>
</div>  

<img src="banner1.jpg" class="banner" alt="GOALSTORM! Banner">

<div id="startupPopup" class="arcade-popup" style="display:flex; border-color: var(--warn);">
    <button class="popup-close-x" id="startupClose">âœ•</button>
    <div class="popup-msg" style="color:var(--warn); line-height:1.5;">
        THE SUBMISSION WINDOW WILL OPEN NEAR TO THE START OF THE TOURNAMENT.
        <br><br>
        YOU CAN CLICK THROUGH THE PAGE TO UNDERSTAND THE GAME BUT YOUR SELECTIONS WILL NOT BE SUBMITTED AT THIS STAGE.
    </div>
</div>

<div class="panel">
<h1>PLAYER ENTRY TERMINAL</h1>

<input id="username" placeholder="USERNAME (REQUIRED)">
<input id="email" placeholder="ENTER USERNAME FIRST" disabled>

<input id="leaguePin" placeholder="LEAGUE PIN (OPTIONAL)" maxlength="4">

<div class="terms-container">
    <label><input type="checkbox" id="privacyCheck"> <span class="required-text">*REQUIRED:</span> I AGREE TO PRIVACY POLICY</label>
    <label><input type="checkbox" id="termsCheck"> <span class="required-text">*REQUIRED:</span> I AGREE TO TERMS OF USE</label>
    <label><input type="checkbox" id="marketingCheck"> I WANT TO HEAR ABOUT FUTURE GOALSTORM COMPETITIONS (OPTIONAL)</label>
</div>

<button id="comboTrigger" style="width:100%; margin:12px 0;" disabled>CHOOSE GOALSCORER COMBINATION</button>
<select id="combo" style="display:none;" disabled>
    <option value="">GOALSCORER COMBINATION</option>
    <option>Messi & Ronaldo</option>
    <option>Neymar & MbappÃ©</option>
    <option>Lewandowski & Haaland</option>
    <option>Salah & ManÃ©</option>
    <option>Kane & Sterling</option>
    <option>ModriÄ‡ & De Bruyne</option>
    <option>MbappÃ© & Benzema</option>
    <option>Son & Raphinha</option>
    <option>Haaland & De Bruyne</option>
    <option>VinÃ­cius & Pedri</option>
</select>

<input id="goals" placeholder="ENTER IDENTITY FIRST" type="number" disabled>

<div class="sys" id="s1msg">AWAITING PLAYER IDENTITY...</div>
</div>  

<div class="panel">
<h1>ROUND 1</h1>
<div class="sys intro">PICKING 1ST PLACE IS TOO EASY.</div>
<div class="sys prominent">SELECT 2ND PLACE IN EACH GROUP AND SELECT 8 THIRD-PLACE QUALIFIERS</div>
<div class="groups-grid" id="groupsGrid"></div>
</div> 

<button id="lockBtn" disabled>LOCK PICKS & PROCEED TO RANDOM PLAYER SELECTOR</button>

<div id="arcadePopup" class="arcade-popup">
    <div class="popup-msg" id="popupMsg"></div>
    <div id="progressBarContainer" style="display:none; width:100%;">
        <div class="progress-track">
            <div id="progressFill" class="progress-fill"></div>
        </div>
    </div>
    <button id="popupBtn" class="popup-btn">OK</button>
</div>

<div id="infoTooltip" class="info-tooltip">
    <div class="tooltip-text" id="tooltipText"></div>
</div>

<div class="overlay" id="overlay">
  <div class="modal">
    <div class="top-player" id="topPlayer"></div>
    <div class="subtitle">is your random player. Do you want to</div>
    <div class="actions">
      <button id="stickBtn">STICK (AND SUBMIT)</button>
      <button id="twistBtn">TWIST (2 REMAINING)</button>
    </div>
    <div class="grid" id="grid"></div>
    <div class="info" id="info"></div>
    <div class="success" id="success">PICKS SUBMITTED!</div>
  </div>
</div>  

<div class="submit-overlay" id="submitOverlay">
  <div class="submit-box">
    <h2>PICKS RECORDED</h2>
    <div class="details" id="summary"></div>
    <div class="hint">Take a screenshot of this screen for your records.</div>
    <div class="hint" style="color:var(--warn); margin-top:10px; border-top:1px solid #333; padding-top:10px;">
        NOTE: SUBMISSION WINDOW IS CURRENTLY CLOSED.<br>NO DATA WAS SENT TO THE SERVER.
    </div>
    <a href="index.html">RETURN TO HOME SCREEN</a>
  </div>
</div> 

<script>
'use strict';
/* ---------- STARTUP POPUP LOGIC ---------- */
const startupPopup = document.getElementById('startupPopup');
const startupClose = document.getElementById('startupClose');
startupClose.onclick = () => { startupPopup.style.display = 'none'; };

/* ---------- STATE VARIABLES ---------- */
const usernameInput=document.getElementById('username'),
emailInput=document.getElementById('email'),
privacyCheck=document.getElementById('privacyCheck'),
termsCheck=document.getElementById('termsCheck'),
marketingCheck=document.getElementById('marketingCheck'),
leaguePinInput=document.getElementById('leaguePin'),
comboSelect=document.getElementById('combo'),
comboTrigger=document.getElementById('comboTrigger'),
goalsInput=document.getElementById('goals'),
s1msg=document.getElementById('s1msg'),
lockBtn=document.getElementById('lockBtn'),
nav=document.getElementById('nav');

// Info tooltip logic
const infoTooltip = document.getElementById('infoTooltip');
const tooltipText = document.getElementById('tooltipText');
let tooltipTimeout;
function showTooltip(msg, duration = 4000) {
    tooltipText.textContent = msg;
    infoTooltip.style.display = 'block';
    clearTimeout(tooltipTimeout);
    tooltipTimeout = setTimeout(() => {
        infoTooltip.style.display = 'none';
    }, duration);
}

// Tooltips
usernameInput.addEventListener('focus', () => showTooltip('USERNAME WILL BE PUBLICLY VIEWABLE', 3000));
leaguePinInput.addEventListener('focus', () => showTooltip('Join an existing league using a code or enter a new code and share it with your friends!', 5000));
comboSelect.addEventListener('focus', () => showTooltip('These two players and your Bonus Player will earn points for you with goals and assists.', 6000));
goalsInput.addEventListener('focus', () => showTooltip('Enter total goals in all group stage matches - this is the tiebreaker.', 7000));

/* ---------- MASTER FLOW CONTROLLER ---------- */
function updateTerminalState() {
    const isNameValid = usernameInput.value.trim().length > 2;
    const isEmailValid = emailInput.value.includes('@') && emailInput.value.includes('.');
    const isComboSelected = comboSelect.value !== "";
    const isGoalsValid = goalsInput.value > 0;
    
    // 1. IDENTITY PHASE
    if (!isNameValid) {
        // Lock downstream
        emailInput.disabled = true;
        emailInput.placeholder = "ENTER USERNAME FIRST";
        
        comboTrigger.disabled = true;
        comboTrigger.innerText = "COMPLETE IDENTITY FIRST";
        comboSelect.disabled = true;
        
        goalsInput.disabled = true;
        goalsInput.placeholder = "COMPLETE IDENTITY FIRST";
        
        s1msg.textContent = "AWAITING PLAYER IDENTITY...";
        s1msg.className = "sys";
    } else {
        // Unlock Email
        emailInput.disabled = false;
        emailInput.placeholder = "EMAIL ADDRESS (REQUIRED)";
        
        if (!isEmailValid) {
            // Lock Scoring
            comboTrigger.disabled = true;
            comboTrigger.innerText = "ENTER VALID EMAIL FIRST";
            comboSelect.disabled = true;
            
            goalsInput.disabled = true;
            goalsInput.placeholder = "ENTER VALID EMAIL FIRST";
            
            s1msg.textContent = "PLEASE ENTER A VALID EMAIL...";
            s1msg.className = "sys";
        } else {
            // 2. SCORING SETUP PHASE
            // Check if combo explanation happened, we handle visual state here
            if(comboSelect.style.display === 'none'){
                comboTrigger.disabled = false;
                comboTrigger.innerText = "CHOOSE GOALSCORER COMBINATION";
            } else {
                 comboSelect.disabled = false;
            }

            if (!isComboSelected) {
                goalsInput.disabled = true;
                goalsInput.placeholder = "SELECT COMBINATION FIRST";
                s1msg.textContent = "IDENTITY CONFIRMED â€” SELECT SCORERS";
                s1msg.className = "sys active";
            } else {
                goalsInput.disabled = false;
                goalsInput.placeholder = "TOTAL GROUP STAGE GOALS";
                
                if (!isGoalsValid) {
                    s1msg.textContent = "ENTER PREDICTED TOTAL GOALS";
                    s1msg.className = "sys active";
                } else {
                    s1msg.textContent = "PLAYER DATA READY â€” COMPLETE GROUP PICKS";
                    s1msg.className = "sys complete";
                }
            }
        }
    }

    // 4. LOCK BUTTON LOGIC
    const termsAgreed = privacyCheck.checked && termsCheck.checked;
    const secondComplete = state.secondPicks.every(x => x !== null);
    const thirdComplete = state.thirdPicks.filter(x => x !== null).length === MAX_THIRD;
    const terminalComplete = isNameValid && isEmailValid && isComboSelected && isGoalsValid;

    lockBtn.disabled = !(terminalComplete && termsAgreed && secondComplete && thirdComplete);
}

// Bind all inputs to Master Controller
usernameInput.addEventListener('input', updateTerminalState);
emailInput.addEventListener('input', updateTerminalState);
comboSelect.addEventListener('change', updateTerminalState);
goalsInput.addEventListener('input', updateTerminalState);
privacyCheck.addEventListener('change', updateTerminalState);
termsCheck.addEventListener('change', updateTerminalState);

// League Pin just needs max length check, doesn't block flow
leaguePinInput.addEventListener('input', (e) => {
    if(e.target.value.length > 4) e.target.value = e.target.value.slice(0,4);
});

// Combo Popup Logic
comboTrigger.onclick = () => {
    showPopup("These two players and your Bonus Player (chosen at the end) will earn points for you with goals and assists in the Group Stage.", false);
    
    // Override popup OK button
    const oldAction = popupBtn.onclick;
    popupBtn.onclick = () => {
        popup.style.display = 'none';
        comboTrigger.style.display = 'none';
        comboSelect.style.display = 'block';
        comboSelect.disabled = false;
        // Trigger generic state update
        updateTerminalState();
        // Restore default popup closer
        popupBtn.onclick = () => { popup.style.display = 'none'; }; 
    };
};

/* ---------- STAGE 2 (GROUP PICKS) ---------- */
const GROUPS=[ 
["MEXICO ðŸ‡²ðŸ‡½","SOUTH AFRICA ðŸ‡¿ðŸ‡¦","SOUTH KOREA ðŸ‡°ðŸ‡·","DEN/MAC/CZE/IRL"],
["CANADA ðŸ‡¨ðŸ‡¦","ITA/NIR/WAL/BOS","QATARðŸ‡¶ðŸ‡¦","SWITZERLANDðŸ‡¨ðŸ‡­"],
["BRAZIL ðŸ‡§ðŸ‡·","MOROCCOðŸ‡²ðŸ‡¦","HAITIðŸ‡­ðŸ‡¹","SCOTLANDðŸ´"],
["USA ðŸ‡ºðŸ‡¸","PARAGUAYðŸ‡µðŸ‡¾","AUSTRALIAðŸ‡¦ðŸ‡º","TUR/ROU/SVK/KOS"],
["GERMANY ðŸ‡©ðŸ‡ª","CURAÃ‡AOðŸ‡¨ðŸ‡¼","IVORY COAST ðŸ‡¨ðŸ‡®","ECUADOR ðŸ‡ªðŸ‡¨"],
["NETHERLANDS ðŸ‡³ðŸ‡±","JAPANðŸ‡¯ðŸ‡µ","UKR/SWE/POL/ALB","TUNISIAðŸ‡¹ðŸ‡³"],
["BELGIUM ðŸ‡§ðŸ‡ª","EGYPTðŸ‡ªðŸ‡¬","IRANðŸ‡®ðŸ‡·","NEW ZEALAND ðŸ‡³ðŸ‡¿"],
["SPAIN ðŸ‡ªðŸ‡¸","CAPE VERDE ðŸ‡¨ðŸ‡»","SAUDI ARABIA ðŸ‡¸ðŸ‡¦","URUGUAYðŸ‡ºðŸ‡¾"],
["FRANCE ðŸ‡«ðŸ‡·","SENEGALðŸ‡¸ðŸ‡³","BOL/SUR/IRQ","NORWAYðŸ‡³ðŸ‡´"],
["ARGENTINA ðŸ‡¦ðŸ‡·","ALGERIAðŸ‡©ðŸ‡¿","AUSTRIAðŸ‡¦ðŸ‡¹","JORDANðŸ‡¯ðŸ‡´"],
["PORTUGAL ðŸ‡µðŸ‡¹","JAM/NCL/DRC","UZBEKISTANðŸ‡ºðŸ‡¿","COLOMBIAðŸ‡¨ðŸ‡´"],
["ENGLAND ðŸ´","CROATIA ðŸ‡­ðŸ‡·","GHANAðŸ‡¬ðŸ‡­","PANAMAðŸ‡µðŸ‡¦"]
];
const letters="ABCDEFGHIJKL".split('');
const MAX_THIRD=8;
const state={ secondPicks:Array(GROUPS.length).fill(null),
thirdPicks:Array(GROUPS.length).fill(null) };
const groupsGrid=document.getElementById('groupsGrid');

// POPUP LOGIC
const popup = document.getElementById('arcadePopup');
const popupMsg = document.getElementById('popupMsg');
const popupBtn = document.getElementById('popupBtn');
const progressBarContainer = document.getElementById('progressBarContainer');
const progressFill = document.getElementById('progressFill');
popupBtn.onclick = () => { popup.style.display = 'none'; };

function showPopup(msg, isProgress=false, count=0) {
    popupMsg.textContent = msg;
    popup.style.display = 'flex';
    
    if(isProgress) {
        popup.classList.add('progress-mode');
        popupBtn.style.display = 'none'; // Auto close for progress
        progressBarContainer.style.display = 'block';
        const pct = (count / MAX_THIRD) * 100;
        progressFill.style.width = pct + '%';
        setTimeout(() => { popup.style.display = 'none'; }, 1500);
    } else {
        popup.classList.remove('progress-mode');
        popupBtn.style.display = 'block';
        progressBarContainer.style.display = 'none';
    }
}

function createGroupEl(groupIndex, teams){
    const g=document.createElement('div'); g.className='group';
    g.innerHTML = `<h4>GROUP ${letters[groupIndex]}</h4><div class="team-list"></div>`;
    const list=g.querySelector('.team-list');
    teams.forEach((team,idx)=>{
        const row=document.createElement('div');
        row.className='team-row';
        const nameSpan=document.createElement('span');
        nameSpan.className='team-name'; nameSpan.textContent=team;
        const btn2=document.createElement('button');
        btn2.className='team-btn'; btn2.textContent='2nd';
        btn2.onclick=()=>toggleSecond(groupIndex,idx,btn2);
        const btn3=document.createElement('button');
        btn3.className='team-btn'; btn3.textContent='3rd';
        btn3.onclick=()=>toggleThird(groupIndex,idx,btn3);
        row.append(nameSpan,btn2,btn3); list.appendChild(row);
    });
    return g;
}

function renderGroups(){ groupsGrid.innerHTML='';
GROUPS.forEach((g,i)=>groupsGrid.appendChild(createGroupEl(i,g))); }
renderGroups();

function toggleSecond(group,i,btn){
    if(state.thirdPicks[group]===i){ showPopup('ERROR: Team already selected as 3rd-place'); return; }
    state.secondPicks[group]=state.secondPicks[group]===i?null:i;
    btn.closest('.team-list').querySelectorAll('.selected-2').forEach(b=>b.classList.remove('selected-2'));
    if(state.secondPicks[group]===i) btn.classList.add('selected-2');
    updateTerminalState();
}

function toggleThird(group,i,btn){
    if(state.secondPicks[group]===i){ showPopup('ERROR: Team already selected as 2nd-place'); return; }
    const total=state.thirdPicks.filter(x=>x!==null).length;
    // Deselecting
    if(state.thirdPicks[group]===i){
        state.thirdPicks[group]=null; 
        btn.classList.remove('selected-3'); 
        const newTotal = state.thirdPicks.filter(x=>x!==null).length;
        showPopup(`${newTotal} THIRD-PLACE TEAMS SELECTED, ${MAX_THIRD - newTotal} REMAINING`, true, newTotal);
    }
    else{
        // Selecting
        if(total>=MAX_THIRD){ showPopup('ERROR: YOU HAVE ALREADY SELECTED 8 THIRD-PLACE QUALIFIERS'); return; }
        btn.closest('.team-list').querySelectorAll('.selected-3').forEach(b=>b.classList.remove('selected-3'));
        state.thirdPicks[group]=i; 
        btn.classList.add('selected-3');
        const newTotal = state.thirdPicks.filter(x=>x!==null).length;
        showPopup(`${newTotal} THIRD-PLACE TEAMS SELECTED, ${MAX_THIRD - newTotal} REMAINING`, true, newTotal);
    }
    updateTerminalState();
}

/* ---------- RANDOM SELECTOR LOGIC ---------- */
const PLAYERS=['MESSI','RONALDO','MBAPPÃ‰','HAALAND','SALAH','KANE','NEYMAR','BENZEMA','MODRIÄ†','DE BRUYNE','VINÃCIUS','PEDRI','GRIEZMANN','BELLINGHAM','LEWANDOWSKI','SON','OSIMHEN','SAKA','RASHFORD','ALVAREZ','GREALISH','FODEN','Ã˜DEGAARD','MUSIALA','KVARA','VALVERDE','DIMARIA','LUKAKU','DAVIES','RODRI'];
let twistsRemaining=2, finalPlayer=null, finalIndex=null, locked=false;
const NEON_COLORS = ['#00F6FF', '#FF2FC7', '#22FF88', '#FFD60A', '#B026FF', '#FF5E00'];
const overlay=document.getElementById('overlay'),
gridEl=document.getElementById('grid'),
topPlayerEl=document.getElementById('topPlayer'),
stickBtn=document.getElementById('stickBtn'),
twistBtn=document.getElementById('twistBtn'),
submitOverlay=document.getElementById('submitOverlay'),
summaryEl=document.getElementById('summary');

lockBtn.onclick=()=>{ nav.style.display='none';
overlay.style.display='flex'; initRandomPlayer(); };

function initRandomPlayer(){
    gridEl.innerHTML=''; twistsRemaining=2; locked=false;
    PLAYERS.forEach(n=>{ const
    d=document.createElement('div'); d.className='player-box'; d.textContent=n;
    gridEl.appendChild(d); });
    finalIndex=Math.floor(Math.random()*PLAYERS.length);
    finalPlayer=PLAYERS[finalIndex];
    topPlayerEl.textContent=finalPlayer;
    const boxes=document.querySelectorAll('.player-box');
    boxes[finalIndex].classList.add('selected');
    updateTwistText();
}

function updateTwistText(){ twistBtn.textContent=`TWIST (${twistsRemaining} REMAINING)`; }
function countdownThen(cb){
    let i=0,msg=['READY','SET','TWIST!'];
    const t=setInterval(()=>{
    topPlayerEl.textContent=msg[i++]; if(i===msg.length){ clearInterval(t); cb();
    }},250);
}

stickBtn.onclick=()=>{ if(locked) return; locked=true;
freezeFrame(); showSummary(); };

twistBtn.onclick=()=>{
 if(locked||twistsRemaining===0) return;
  twistsRemaining--;
  updateTwistText();
 document.querySelectorAll('.player-box').forEach(b=>{
   b.classList.remove('selected','active');
    b.style='';
  });
 finalIndex=Math.floor(Math.random()*PLAYERS.length);
 finalPlayer=PLAYERS[finalIndex];
 countdownThen(()=>runTwistAnimation(()=>{
   topPlayerEl.textContent=finalPlayer;
   if(twistsRemaining===0){ locked=true; freezeFrame(); showSummary(); }
  }));
};

function runTwistAnimation(done){
  const boxes = document.querySelectorAll('.player-box');
  let current = 0;
  let loops = 0;
  const maxLoops = 2; 
  const interval = setInterval(() => {
    boxes.forEach(b => {
     b.classList.remove('active');
      b.style = ''; 
    });
    const randomColor = NEON_COLORS[Math.floor(Math.random() * NEON_COLORS.length)];
    const b = boxes[current];
    b.classList.add('active');
    b.style.background = randomColor;
    b.style.borderColor = randomColor;
    b.style.boxShadow = `0 0 15px ${randomColor}`;
    b.style.color = '#000';
    topPlayerEl.textContent = b.textContent;
    if(loops >= maxLoops && current === finalIndex) {
     clearInterval(interval);
     b.style = '';
     b.classList.remove('active');
     b.classList.add('selected');
      done();
    } else {
      current++;
      if(current >= boxes.length) {
        current = 0;
        loops++;
      }
    }
  }, 50); 
}

function freezeFrame(){ topPlayerEl.classList.add('shake');
setTimeout(()=>topPlayerEl.classList.remove('shake'),350); }

/* ---------- SUBMIT FUNCTION ---------- */
function showSummary(){
  setTimeout(()=>{
   overlay.style.display='none';
    
    // FETCH REMOVED - SUBMISSION LOCKED 
    
    const players=[...comboSelect.value.split('&').map(p=>p.trim().toUpperCase()),finalPlayer.toUpperCase()];
    
    let html = `<div class="summary-header">USER: ${usernameInput.value}<br>EMAIL: ${emailInput.value}</div>`;
    html += `<div class="summary-players">PLAYERS: ${players.join(', ')}</div>`;
    html += `<div class="summary-grid">`;
   GROUPS.forEach((g,i)=>{
      html += `<div class="summary-item">`;
     html += `<h5>GROUP ${letters[i]}</h5>`;
     html += `<span>2ND: ${g[state.secondPicks[i]]}</span>`;
     if(state.thirdPicks[i]!==null){
        html += `<span class="third">3RD: ${g[state.thirdPicks[i]]}</span>`;
      }
     html += `</div>`;
    });
   html += `</div>`;
   summaryEl.innerHTML=html;
   submitOverlay.style.display='flex';
  }, 800);
}

// Initial state check
updateTerminalState();
</script> </body>
</html>

```
